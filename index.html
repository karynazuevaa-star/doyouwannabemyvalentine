<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–í–∞–ª–µ–Ω—Ç–∏–Ω–∫–∞ üíò</title>

  <style>
    :root{
      --bg:#3a0b16;
      --bg2:#19050b;
      --ink:#2b0a10;
      --accent:#ff4d6d;
    }
    *{ box-sizing:border-box; }

    body{
      margin:0;
      height:100vh;
      overflow:hidden;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background:
        radial-gradient(1100px 600px at 20% 15%, rgba(255,255,255,0.06), transparent 60%),
        radial-gradient(900px 550px at 85% 70%, rgba(255,255,255,0.05), transparent 55%),
        linear-gradient(135deg, var(--bg), var(--bg2));
    }

    /* –ø–∞–¥–∞—é—â–∏–µ —Å–µ—Ä–¥–µ—á–∫–∏ */
    #hearts{ position:fixed; inset:0; pointer-events:none; z-index:0; overflow:hidden; }
    .heart{
      position:absolute; top:-12vh; user-select:none; opacity:0.95;
      filter: drop-shadow(0 8px 14px rgba(0,0,0,0.25));
      animation: fall linear forwards;
    }
    @keyframes fall{
      0%{ transform: translateY(-12vh) rotate(0deg); opacity:0; }
      10%{ opacity:0.95; }
      100%{ transform: translateY(115vh) rotate(360deg); opacity:0; }
    }

    .stage{
      position:relative;
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:1;
    }

    .wrap{
      position:relative;
      width:min(920px, 96vw);
      aspect-ratio: 16/9;
      display:flex;
      align-items:center;
      justify-content:center;
      filter: drop-shadow(0 22px 50px rgba(0,0,0,0.45));
    }

    /* –±–µ–ª–∞—è –ø–æ–¥–ª–æ–∂–∫–∞ –ø–æ–¥ —Å–∞–ª—Ñ–µ—Ç–∫—É, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ "—à–∞—Ö–º–∞—Ç–∫–∏" –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ */
    .doily-under{
      position:absolute;
      inset:6%;
      background:#ffffff;
      border-radius:24px;
      z-index:1;
      opacity:0.98;
    }

    /* —Å–∞–ª—Ñ–µ—Ç–∫–∞ */
    .doily-img{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:contain;
      z-index:2;
      pointer-events:none;
    }

    /* —Ö–æ–º—è—á–∫–∏ –ü–û–î —Å–∞–ª—Ñ–µ—Ç–∫–æ–π: —Ç–æ–ª—å–∫–æ "–≤—ã–≥–ª—è–¥—ã–≤–∞—é—Ç" (–±–µ–∑ –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ –∫—Ä—É–≥—É) */
    .ham{
      position:absolute;
      width:86px; height:86px;
      image-rendering: pixelated;
      pointer-events:none;
      z-index:1; /* –ø–æ–¥ —Å–∞–ª—Ñ–µ—Ç–∫–æ–π */
      opacity:0;
      transform: translateY(18px) rotate(0deg);
      filter: drop-shadow(0 10px 18px rgba(0,0,0,0.25));
      animation: peek 4.2s ease-in-out infinite;
    }
    .ham.h2{ width:76px; height:76px; animation-delay: 0.8s; animation-duration: 4.6s; }
    .ham.h3{ width:66px; height:66px; animation-delay: 1.4s; animation-duration: 3.9s; }

    /* —á—É—Ç—å-—á—É—Ç—å –∫—Ä—É—Ç–∏—Ç—Å—è –Ω–∞ –º–µ—Å—Ç–µ, –Ω–æ –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è */
    .ham.spin { animation-name: peek, tinyspin; animation-duration: 4.2s, 2.4s; animation-timing-function: ease-in-out, linear; animation-iteration-count: infinite, infinite; }
    .ham.h2.spin{ animation-duration: 4.6s, 2.9s; }
    .ham.h3.spin{ animation-duration: 3.9s, 2.6s; }

    @keyframes peek{
      0%, 35%   { opacity:0; transform: translateY(22px) rotate(0deg); }
      45%, 75%  { opacity:1; transform: translateY(0px) rotate(0deg); }
      85%, 100% { opacity:0; transform: translateY(22px) rotate(0deg); }
    }
    @keyframes tinyspin{
      0%{ transform: translateY(0px) rotate(0deg); }
      100%{ transform: translateY(0px) rotate(360deg); }
    }

    /* –ø–æ—Ü–µ–ª—É–π ‚Äî –º–µ–Ω—å—à–µ –∏ –ø–æ–¥ –∫–Ω–æ–ø–∫–∞–º–∏ */
    .kiss{
      position:absolute;
      z-index:2; /* –ø–æ–¥ –∫–∞—Ä—Ç–æ—á–∫–æ–π */
      width:min(145px, 30vw);
      opacity:0.85;
      left: 58%;
      top: 60%;
      transform: translate(-50%, -50%) rotate(-10deg);
      pointer-events:none;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,0.18));
    }

    /* –∫–∞—Ä—Ç–æ—á–∫–∞ */
    .card{
      position:relative;
      z-index:3;
      width:min(580px, 88vw);
      padding:30px 24px 22px;
      text-align:center;
      color:var(--ink);
      border-radius:26px;
      background: linear-gradient(#ffffff, #fff6fb);
      box-shadow: inset 0 0 0 2px rgba(255,77,109,0.10);
    }

    h1{
      margin:0 0 14px;
      font-size: clamp(22px, 4.6vw, 32px);
      line-height:1.15;
    }

    .btnrow{
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top:10px;
      position:relative;
      z-index:10;
    }

    button{
      font-size:18px;
      padding:12px 22px;
      border:none;
      border-radius:14px;
      cursor:pointer;
      user-select:none;
      touch-action: manipulation;
      transition: transform .12s ease, filter .12s ease;
    }
    button:active{ transform: translateY(1px) scale(0.99); }

    #yes{
      background: var(--accent);
      color:#fff;
      font-weight:800;
      box-shadow: 0 10px 22px rgba(255,77,109,0.25);
    }

    /* "–ù–µ—Ç" ‚Äî —Å–Ω–∞—á–∞–ª–∞ –æ–±—ã—á–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —Ä—è–¥–æ–º —Å "–î–∞" */
    #no{
      background:#e7e0e6;
      color:#3b1a22;
      font-weight:700;
      position:relative;
      z-index:10;
    }

    /* –∫–æ–≥–¥–∞ —É–±–µ–≥–∞–µ—Ç */
    #no.runaway{
      position:fixed;
      z-index:999;
      left:0; top:0;
    }

    #message{
      margin:12px 0 0;
      min-height: 24px;
      font-size:16px;
      color:#8a0a26;
      position:relative;
      z-index:10;
    }

    /* —Å–∞–ª—é—Ç */
    #fw{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:10;
      display:none;
    }
    .final{
      position:relative;
      z-index:11;
      text-align:center;
      color:#fff;
      font-weight:900;
      font-size: clamp(34px, 6vw, 68px);
      letter-spacing: 0.5px;
      text-shadow: 0 14px 34px rgba(0,0,0,0.55);
      padding: 24px;
    }
  </style>
</head>

<body>
  <div id="hearts" aria-hidden="true"></div>
  <canvas id="fw"></canvas>

  <div class="stage" id="stage">
    <div class="wrap" id="wrap">

      <!-- —Ö–æ–º—è—á–∫–∏ –ø–æ–¥ —Å–∞–ª—Ñ–µ—Ç–∫–æ–π: —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ -->
      <img class="ham h1 spin" src="./hamster.png" alt="" style="left:10%; top:32%;">
      <img class="ham h2 spin" src="./hamster.png" alt="" style="left:18%; top:82%;">
      <img class="ham h3 spin" src="./hamster.png" alt="" style="left:86%; top:72%;">

      <!-- –±–µ–ª–∞—è –ø–æ–¥–ª–æ–∂–∫–∞ -->
      <div class="doily-under" aria-hidden="true"></div>

      <!-- —Å–∞–ª—Ñ–µ—Ç–∫–∞ -->
      <img class="doily-img" src="./doily.png" alt="" onerror="this.style.display='none'">

      <!-- –ø–æ—Ü–µ–ª—É–π -->
      <img class="kiss" src="./kiss.png" alt="">

      <div class="card">
        <h1>–ë—É–¥–µ—à—å –ª–∏ —Ç—ã –º–æ–µ–π –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ–π? üíò</h1>

        <div class="btnrow">
          <button id="yes">–î–∞ ‚ù§Ô∏è</button>
          <button id="no">–ù–µ—Ç</button>
        </div>

        <div id="message"></div>
      </div>

    </div>
  </div>

  <script>
    // —Å–µ—Ä–¥–µ—á–∫–∏
    const heartsBox = document.getElementById('hearts');
    const heartChars = ["‚ù§","üíó","üíñ","üíò","üíû"];
    function spawnHeart(){
      const h = document.createElement('div');
      h.className = 'heart';
      h.textContent = heartChars[Math.floor(Math.random()*heartChars.length)];
      h.style.left = (Math.random()*100) + "vw";
      h.style.fontSize = (14 + Math.random()*18) + "px";
      const dur = 7 + Math.random()*7;
      h.style.animationDuration = dur + "s";
      heartsBox.appendChild(h);
      setTimeout(()=>h.remove(), (dur+1)*1000);
    }
    setInterval(spawnHeart, 230);
    for(let i=0;i<18;i++) setTimeout(spawnHeart, i*120);

    // "–ù–µ—Ç" ‚Äî —Ä—è–¥–æ–º —Å "–î–∞", –∏ –ù–ï –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —ç–∫—Ä–∞–Ω
    const noBtn = document.getElementById("no");
    const message = document.getElementById("message");
    let runaway = false;

    const PAD = 12;        // –∑–∞–ø–∞—Å –æ—Ç –∫—Ä–∞—ë–≤
    const TRIGGER = 120;   // –Ω–∞—Å–∫–æ–ª—å–∫–æ –±–ª–∏–∑–∫–æ –∫—É—Ä—Å–æ—Ä, —á—Ç–æ–±—ã —É–±–µ–≥–∞—Ç—å

    function clamp(v, a, b){ return Math.max(a, Math.min(b, v)); }
    function centerOf(rect){ return { x: rect.left + rect.width/2, y: rect.top + rect.height/2 }; }

    function enableRunaway(){
      if (runaway) return;

      // —Ñ–∏–∫—Å–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É —Ä–æ–≤–Ω–æ —Ç–∞–º, –≥–¥–µ –æ–Ω–∞ –±—ã–ª–∞ —Ä—è–¥–æ–º —Å "–î–∞"
      const r = noBtn.getBoundingClientRect();
      noBtn.classList.add("runaway");
      noBtn.style.left = r.left + "px";
      noBtn.style.top  = r.top  + "px";
      runaway = true;
    }

    function pushAway(cx, cy){
      // –µ—Å–ª–∏ –µ—â—ë –Ω–µ —É–±–µ–≥–∞–µ—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä–∏–º –¥–∏—Å—Ç–∞–Ω—Ü–∏—é
      if (!runaway){
        const r0 = noBtn.getBoundingClientRect();
        const c0 = centerOf(r0);
        const d0 = Math.hypot(c0.x - cx, c0.y - cy);
        if (d0 <= TRIGGER) enableRunaway();
        else return;
      }

      const w = noBtn.offsetWidth;
      const h = noBtn.offsetHeight;

      // —Ç–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è –∫–Ω–æ–ø–∫–∏ (fixed)
      const left = parseFloat(noBtn.style.left || "0");
      const top  = parseFloat(noBtn.style.top  || "0");

      // —Ü–µ–Ω—Ç—Ä –∫–Ω–æ–ø–∫–∏
      const bx = left + w/2;
      const by = top  + h/2;

      const dx = bx - cx;
      const dy = by - cy;
      const dist = Math.hypot(dx, dy);

      if (dist > TRIGGER) return;

      const nx = dx / (dist || 1);
      const ny = dy / (dist || 1);

      const strength = (TRIGGER - dist) / TRIGGER;
      const step = 18 + strength * 34;

      let newLeft = left + nx * step;
      let newTop  = top  + ny * step;

      // –∂—ë—Å—Ç–∫–æ –¥–µ—Ä–∂–∏–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —ç–∫—Ä–∞–Ω–∞ (–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–π–¥–µ—Ç)
      newLeft = clamp(newLeft, PAD, window.innerWidth  - w - PAD);
      newTop  = clamp(newTop,  PAD, window.innerHeight - h - PAD);

      noBtn.style.left = newLeft + "px";
      noBtn.style.top  = newTop  + "px";
    }

    // –∑–∞–ø—É—Å–∫ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏—è
    document.addEventListener("mousemove", (e) => pushAway(e.clientX, e.clientY));
    noBtn.addEventListener("mouseenter", () => {
      // –µ—Å–ª–∏ –ø—Ä—è–º–æ –Ω–∞–≤–µ–ª–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É ‚Äî –≤–∫–ª—é—á–∞–µ–º —Ä–µ–∂–∏–º –Ω–∞–≤–µ—Ä–Ω—è–∫–∞
      enableRunaway();
    });

    // –º–æ–±–∏–ª–∫–∞: –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Ç–∞–ø–Ω—É—Ç—å ‚Äî –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–µ–º
    noBtn.addEventListener("touchstart", (e) => {
      const t = e.touches[0];
      pushAway(t.clientX, t.clientY);
      e.preventDefault();
    }, {passive:false});

    noBtn.addEventListener("click", () => {
      message.textContent = "–¥–æ—Ä–æ–≥–æ–π –≤–∏—Ç–∞–ª–∏–∫, —Ç—ã –∑–∞–±—ã–ª —Å –∫–µ–º –∂–∏–≤–µ—à—å. —Ç—É—Ç –Ω–µ—Ç –≤—ã–±–æ—Ä–∞. –ø–æ–¥—É–º–∞–π –µ—â–µ —Ä–∞–∑ :)";
    });

    // "–î–∞" -> "—è –∑–Ω–∞–ª–∞!!!" + —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫–∏ (–±–µ–∑ —ç–º–æ–¥–∑–∏)
    const yesBtn = document.getElementById("yes");
    const stage = document.getElementById("stage");
    const wrap = document.getElementById("wrap");
    const fw = document.getElementById("fw");
    const ctx = fw.getContext("2d");
    let particles = [];

    function burst(x,y){
      const count = 80 + Math.floor(Math.random()*50);
      for(let i=0;i<count;i++){
        const a = Math.random()*Math.PI*2;
        const s = 2 + Math.random()*5.5;
        particles.push({ x,y, vx:Math.cos(a)*s, vy:Math.sin(a)*s, life:75+Math.random()*35, r:2+Math.random()*2.7, hue:Math.random()*360 });
      }
    }
    function tick(){
      ctx.clearRect(0,0,fw.width,fw.height);
      ctx.fillStyle = "rgba(0,0,0,0.16)";
      ctx.fillRect(0,0,fw.width,fw.height);

      particles = particles.filter(p => p.life>0);
      for(const p of particles){
        p.life -= 1;
        p.vy += 0.06;
        p.vx *= 0.99; p.vy *= 0.99;
        p.x += p.vx; p.y += p.vy;

        ctx.beginPath();
        ctx.fillStyle = `hsla(${p.hue}, 95%, 65%, ${Math.max(p.life/110,0)})`;
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fill();
      }
      if (fw.style.display !== "none") requestAnimationFrame(tick);
    }

    yesBtn.addEventListener("click", () => {
      fw.style.display = "block";
      fw.width = window.innerWidth;
      fw.height = window.innerHeight;

      wrap.style.display = "none";
      stage.innerHTML = `<div class="final">—è –∑–Ω–∞–ª–∞!!!</div>`;

      const start = performance.now();
      (function loop(t){
        if (t - start < 7000){
          burst(80 + Math.random()*(window.innerWidth-160), 80 + Math.random()*(window.innerHeight*0.45));
          setTimeout(()=>requestAnimationFrame(loop), 130);
        }
      })(start);

      requestAnimationFrame(tick);
    });

    window.addEventListener("resize", () => {
      if (fw.style.display !== "none"){
        fw.width = window.innerWidth;
        fw.height = window.innerHeight;
      }
    });
  </script>
</body>
</html>
